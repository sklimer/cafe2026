# Инструкция по запуску проекта на локальном компьютере

## Требования к системе

- Python 3.8 или выше
- Node.js 16 или выше
- npm или yarn
- PostgreSQL
- Redis (для Celery)

## Подготовка окружения

### 1. Клонирование репозитория

```bash
git clone <адрес_репозитория>
cd cafe2026
```

### 2. Установка зависимостей для бэкенда

Создайте виртуальное окружение Python:

```bash
python -m venv venv
source venv/bin/activate  # На Windows: venv\Scripts\activate
```

Установите зависимости:

```bash
pip install -r requirements.txt
```

### 3. Настройка базы данных

Создайте базу данных PostgreSQL:

```sql
CREATE DATABASE telegram_mini_app;
CREATE USER postgres WITH PASSWORD 'postgres';
GRANT ALL PRIVILEGES ON DATABASE telegram_mini_app TO postgres;
```

Выполните миграции:

```bash
cd /workspace
python manage.py makemigrations
python manage.py migrate
```

### 4. Создание суперпользователя

```bash
python manage.py createsuperuser
```
### 5. Собрать статик файлы

```bash
python manage.py collectstatic
```
## Запуск компонентов

### 1. Запуск бэкенда

В корневой директории проекта выполните:

```bash
cd /workspace
python manage.py runserver
```

Бэкенд будет доступен по адресу `http://127.0.0.1:8000/`

### 2. Запуск админ-панели

Откройте новую вкладку терминала и перейдите в директорию админ-панели:

```bash
cd /workspace/admin_panel
npm install
npm run dev
```

Админ-панель будет доступна по адресу `http://localhost:5173/`

### 3. Запуск фронтенда

Откройте новую вкладку терминала и перейдите в директорию фронтенда:

```bash
cd /workspace/frontend
npm install
npm run dev
```

Фронтенд будет доступен по адресу `http://localhost:5174/` (или другому порту, если 5174 занят)

## Настройка переменных окружения

Для корректной работы приложения рекомендуется создать файл `.env` в корневой директории со следующими переменными:

```env
SECRET_KEY=your_secret_key_here
DEBUG=True
DB_NAME=telegram_mini_app
DB_USER=postgres
DB_PASSWORD=postgres
DB_HOST=localhost
DB_PORT=5432
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
```

## Дополнительные настройки

### Запуск Celery (если используется)

Если приложение использует Celery для фоновых задач:

```bash
# В отдельной вкладке терминала
celery -A backend worker -l info

# Для запуска планировщика (если нужен)
celery -A backend beat -l info
```

### Запуск Redis (если не установлен как сервис)

```bash
redis-server
```

## Структура проекта

- `/backend` - Django API сервер
- `/admin_panel` - Административная панель на React
- `/frontend` - Публичный фронтенд на React

## Возможные проблемы и решения

1. Если возникают ошибки при установке psycopg2-binary на macOS:
   ```bash
   brew install postgresql
   pip install psycopg2-binary
   ```

2. Если возникают проблемы с CORS, проверьте настройки в `backend/settings.py` в разделе `CORS_ALLOWED_ORIGINS`.

3. Для работы с фронтендом и админ-панелью могут потребоваться дополнительные настройки прокси, если они обращаются к разным портам.

После выполнения всех этих шагов все компоненты приложения должны быть запущены и работать корректно.